import{m as h,n as p,b,o as g,t as x,j as s}from"./index-BfOXua5p.js";import{o as j,s as m,u as w,a as f}from"./zod-Cg7SyRqw.js";import{a as u,F as e,B as S}from"./Form-DZNBP01V.js";const y=j({username:m().min(3,"Username is required and must be at least 3 characters"),password:m().min(5,"Password is required and must be at least 5 characters")}),_=h.injectEndpoints({endpoints:a=>({login:a.mutation({query:t=>({url:"/login",method:"POST",body:t})})})}),{useLoginMutation:N}=_,A=()=>{const{register:a,handleSubmit:t,formState:{errors:o}}=w({mode:"onChange",resolver:f(y)}),{t:n}=u(""),[r]=N(),l=p(),d=b();return{register:a,handleSubmit:t,errors:o,onSubmit:async c=>{try{const i=await r({username:c.username,password:c.password}).unwrap();d(g(i.accessToken)),x.success(n("Login successful")),l("/dashboard/orders")}catch(i){console.error("Failed to login:",i)}}}},L=()=>{const{register:a,handleSubmit:t,errors:o,onSubmit:n}=A(),{t:r}=u("");return s.jsx("div",{className:"auth__page",children:s.jsxs(e,{className:"auth__form",onSubmit:t(n),children:[s.jsxs(e.Group,{className:"mb-3",controlId:"formBasicEmail",children:[s.jsx(e.Label,{children:r("Username")}),s.jsx(e.Control,{type:"text",placeholder:r("Enter username"),...a("username")}),s.jsx(e.Text,{className:"auth__form-error",children:o.username?.message})]}),s.jsxs(e.Group,{className:"mb-3",controlId:"formBasicPassword",children:[s.jsx(e.Label,{children:r("Password")}),s.jsx(e.Control,{type:"password",placeholder:r("Enter password"),...a("password")}),s.jsx(e.Text,{className:"auth__form-error",children:o.password?.message})]}),s.jsx(S,{variant:"primary",type:"submit",children:r("Login")})]})})};export{L as AuthPage};
